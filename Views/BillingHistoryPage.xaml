<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="vyaparsathi.Views.BillingHistoryPage"
    Title="Billing History"
    BackgroundColor="#F8FAFC">

    <VerticalStackLayout Padding="20" Spacing="24">

        <!-- Page Header -->
        <VerticalStackLayout Spacing="4">
            <Label Text="Billing History"
                   FontSize="26"
                   FontAttributes="Bold"
                   TextColor="#0F172A"/>
            <Label Text="Search, filter, and review past bills"
                   FontSize="14"
                   TextColor="#64748B"/>
        </VerticalStackLayout>

        <!-- Filters -->
        <Frame BackgroundColor="White"
               CornerRadius="18"
               Padding="16"
               HasShadow="True">

            <VerticalStackLayout Spacing="14">

                <Label Text="Filters"
                       FontSize="16"
                       FontAttributes="Bold"
                       TextColor="#0F172A"/>

                <!-- Search -->
                <SearchBar x:Name="CustomerSearchBar"
                           Placeholder="Search by customer name"
                           FontSize="14"
                           TextChanged="OnSearchChanged"/>

                <!-- Date Range -->
                <Grid ColumnSpacing="12">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <DatePicker x:Name="StartDatePicker"
                                Grid.Column="0"/>

                    <DatePicker x:Name="EndDatePicker"
                                Grid.Column="1"/>

                    <Button Text="Apply"
                            Grid.Column="2"
                            HeightRequest="44"
                            CornerRadius="12"
                            FontAttributes="Bold"
                            BackgroundColor="#2563EB"
                            TextColor="White"
                            Clicked="OnFilterClicked"/>
                </Grid>

            </VerticalStackLayout>
        </Frame>

        <!-- Bills List -->
        <CollectionView x:Name="BillsCollection"
                        SelectionMode="Single"
                        SelectionChanged="OnBillSelected"
                        VerticalOptions="FillAndExpand">

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame BackgroundColor="White"
                           CornerRadius="16"
                           Padding="16"
                           Margin="0,8"
                           HasShadow="True">

                        <Grid ColumnSpacing="12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <!-- Bill Info -->
                            <VerticalStackLayout Spacing="4">
                                <Label Text="{Binding CustomerName}"
                                       FontSize="16"
                                       FontAttributes="Bold"
                                       TextColor="#0F172A"/>

                                <Label Text="{Binding Date, StringFormat='Billed on {0:dd MMM yyyy}'}"
                                       FontSize="12"
                                       TextColor="#64748B"/>
                            </VerticalStackLayout>

                            <!-- Amount -->
                            <Label Text="{Binding TotalAmount, StringFormat='â‚¹{0:F2}'}"
                                   Grid.Column="1"
                                   FontSize="16"
                                   FontAttributes="Bold"
                                   TextColor="#16A34A"
                                   VerticalTextAlignment="Center"/>
                        </Grid>

                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>

        </CollectionView>

    </VerticalStackLayout>
</ContentPage>
