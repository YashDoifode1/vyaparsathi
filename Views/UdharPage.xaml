<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="vyaparsathi.Views.UdharPage"
    Title="Udhar"
    BackgroundColor="#F3F4F6">

    <ScrollView>
        <VerticalStackLayout Spacing="20">

            <!-- HEADER 
            <Grid BackgroundColor="#2563EB" Padding="20">
                <VerticalStackLayout>
                    <Label Text="Udhar"
                           FontSize="26"
                           FontAttributes="Bold"
                           TextColor="White"/>
                    <Label Text="Customer credit management"
                           FontSize="14"
                           TextColor="#DBEAFE"/>
                </VerticalStackLayout>
            </Grid>-->

            <!-- CONTENT -->
            <VerticalStackLayout Padding="20" Spacing="18">

                <!-- UDHAR ENTRY -->
                <Frame BackgroundColor="White"
                       CornerRadius="18"
                       Padding="18">
                    <VerticalStackLayout Spacing="14">

                        <Label Text="Add Udhar"
                               FontSize="18"
                               FontAttributes="Bold"
                               TextColor="#0F172A"/>

                        <!-- CUSTOMER -->
                        <Picker x:Name="CustomerPicker"
                                Title="Select Customer"
                                HeightRequest="50"
                                BackgroundColor="#F1F5F9"/>

                        <!-- AMOUNT -->
                        <Entry x:Name="AmountEntry"
                               Placeholder="Amount (₹)"
                               Keyboard="Numeric"
                               HeightRequest="50"
                               BackgroundColor="#F1F5F9"/>

                        <!-- NOTES -->
                        <Editor x:Name="NotesEditor"
                                Placeholder="Notes (optional)"
                                HeightRequest="90"
                                BackgroundColor="#F1F5F9"/>

                        <!-- SAVE -->
                        <Button Text="Save Udhar"
                                HeightRequest="52"
                                CornerRadius="16"
                                FontAttributes="Bold"
                                BackgroundColor="#DC2626"
                                TextColor="White"
                                Clicked="OnSaveUdharClicked"/>
                    </VerticalStackLayout>
                </Frame>

                <!-- HISTORY -->
                <Label Text="Udhar History"
                       FontSize="18"
                       FontAttributes="Bold"
                       TextColor="#0F172A"/>

                <CollectionView x:Name="UdharCollection"
                                SelectionMode="None">

                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Frame CornerRadius="16"
                                   Padding="14"
                                   Margin="0,6"
                                   BackgroundColor="White">

                                <VerticalStackLayout Spacing="8">

                                    <!-- NAME + AMOUNT -->
                                    <Grid ColumnDefinitions="*,Auto">
                                        <Label Text="{Binding CustomerName}"
                                               FontAttributes="Bold"
                                               TextColor="#0F172A"/>

                                        <Label Text="{Binding Amount, StringFormat='₹{0:F2}'}"
                                               Grid.Column="1"
                                               FontAttributes="Bold"
                                               TextColor="#DC2626"/>
                                    </Grid>

                                    <!-- NOTES -->
                                    <Label Text="{Binding Notes}"
                                           FontSize="13"
                                           TextColor="#475569"
                                           LineBreakMode="TailTruncation"/>

                                    <!-- DATE + DELETE -->
                                    <Grid ColumnDefinitions="*,Auto">
                                        <Label Text="{Binding Date, StringFormat='{0:dd MMM yyyy}'}"
                                               FontSize="12"
                                               TextColor="#94A3B8"/>

                                        <Button Text="Delete"
                                                Grid.Column="1"
                                                FontSize="12"
                                                Padding="12,4"
                                                CornerRadius="12"
                                                BackgroundColor="#EF4444"
                                                TextColor="White"
                                                Clicked="OnDeleteUdharClicked"
                                                CommandParameter="{Binding .}"/>
                                    </Grid>

                                </VerticalStackLayout>
                            </Frame>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>

            </VerticalStackLayout>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
